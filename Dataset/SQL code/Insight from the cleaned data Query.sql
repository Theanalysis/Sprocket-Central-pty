--SALES PERFORMANCE ANALYSIS--
/*1.TOTAL REVENUE GENERATED BY BRAND*/

SELECT Brand,
round(sum(list_price),2) [Total Revenue]
from [Transaction]
where order_status = 'Approved'
group by brand
order by [Total Revenue];

/*TOTAL REVENUE GENERATED BY PRODUCT LINE*/
SELECT product_line,
round(sum(list_price),2) [Total Revenue]
from [Transaction]
where order_status = 'Approved'
group by product_line
order by [Total Revenue];

/*Total Revenue Generated by Product size*/
SELECT product_size,
round(sum(list_price),2) [Total Revenue]
from [Transaction]
where order_status = 'Approved'
group by product_size
order by [Total Revenue]

/*PROFITABILITY PER BRAND*/
SELECT BRAND,round(sum(List_price-Standard_cost),2) as Profit
from [Transaction]
where order_status ='Approved'
group by brand
ORDER BY Profit DESC;


SELECT product_size,round(sum(List_price-Standard_cost),2) as Profit
from [Transaction]
where order_status ='Approved'
group BY  product_size
ORDER BY Profit DESC

--which product lines contribute most to your overall revenue and profits?
SELECT product_line,round(sum(List_price-Standard_cost),2) as Profit
from [Transaction]
where order_status ='Approved'
group BY  product_line
ORDER BY Profit DESC



select sum(list_price - standard_cost)/sum(list_price)
from [Transaction]

--Which Gender is more active in making bike related purchased

select gender,
	count(gender) [count],
	sum(past_3_years_bike_related_purchases) as [Number of bikes purchased]
from Demography
group by gender;



/*Age distribution of customers that purchased bike*/

with [groupping] as
(
select first_name,gender,DOB,past_3_years_bike_related_purchases,DATEDIFF(month,DOB,GETDATE())/12 as Age,
case
		when DATEDIFF(month,DOB,GETDATE())/12 <40 then 'Young Adult'
		when DATEDIFF(month,DOB,GETDATE())/12 between 40 and 59 then 'Middle Age'
		when DATEDIFF(month,DOB,GETDATE())/12 > 59 then 'Old Age'
	end as [Age Group] 
	from Demography
	)
select [Age group],sum(past_3_years_bike_related_purchases) [Number of bike purchased]
from [groupping]
group by [age group]



/* WHICH INDUSTRY ARE MOST ASSOCIATED WITH BIKE RELATED PURCHASE*/

SELECT job_industry_category,SUM(past_3_years_bike_related_purchases) Number_of_bike_Purchase
FROM Demography
GROUP BY (job_industry_category)
ORDER BY Number_of_bike_Purchase DESC




--Which job title purchased bike the most

SELECT job_title,SUM(past_3_years_bike_related_purchases) Number_of_bike_Purchase
FROM Demography
GROUP BY (job_title)
order by Number_of_bike_Purchase desc


--state with the highest property valuation
select state,sum(property_valuation) [Total property valuation]
from [Customer Address]
group by state


--Property Valuation on average
select state,sum(property_valuation)/count(customer_id) as  average_valuation
from [Customer Address]
group by state;











